from pydantic import BaseModel, Field, HttpUrl
from typing import List, Optional

## Pydantic model
class Vulnerability(BaseModel):
    description: str = Field(
        default="No description available", min_length=1, max_length=1000,
        description=(
            "A clear, concise, and technically accurate explanation of the vulnerability. "
            "Must include what the vulnerability is, how it can be exploited, what systems or data are at risk, "
            "and the potential impact if exploited. Avoid vague statements; provide specific technical details and context."
        )
    )

    remediation: str = Field(
        default="No remediation available", min_length=1, max_length=2000,
        description=(
            "A specific, actionable, and technically sound solution or mitigation strategy to address the vulnerability. "
            "Include step-by-step instructions, configuration changes, patches, or compensating controls. "
            "Recommendations must be practical, effective, and, where applicable, reference official vendor or standards documentation. "
            "Avoid generic advice."
        )
    )

    category: str = Field(
        default="Unknown", min_length=1, max_length=50,
        description=(
            "Type or classification of the vulnerability."
            "The standardized type or classification of the vulnerability (e.g., 'SQL Injection', 'Cross-Site Scripting', "
            "'Authentication Bypass', 'Privilege Escalation'). Use widely recognized taxonomies such as OWASP, CWE, or NVD categories."
        )
    )

    severity: str = Field(
        default="unknown", 
        description="Severity level of the vulnerability: low, medium, or high."
    )


class VulnerabilityList(BaseModel):
    vulnerabilities: List[Vulnerability] = Field(
        default=[], 
        description="A list of identified vulnerabilities with corresponding remediation steps."
    )
